Object.keys||(Object.keys=function(a){if(a!==Object(a))throw new TypeError("Object.keys called on a non-object");var b=[],c;for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b});
var pagar_entrega_tipos=[{id:1,value:"dinheiro",label:"Dinheiro"},{id:2,value:"cheque",label:"Cheque"},{id:3,value:"cartao_debito_mastercard",label:"Cart\u00e3o de d\u00e9bito MasterCard"},{id:4,value:"cartao_debito_visa",label:"Cart\u00e3o de d\u00e9bito Visa"},{id:5,value:"cartao_debito_elo",label:"Cart\u00e3o de d\u00e9bito Elo"},{id:6,value:"cartao_debito_cabal",label:"Cart\u00e3o de d\u00e9bito Cabal"},{id:7,value:"cartao_credito_mastercard",label:"Cart\u00e3o de cr\u00e9dito MasterCard"},{id:8,
value:"cartao_credito_visa",label:"Cart\u00e3o de cr\u00e9dito Visa"},{id:9,value:"cartao_credito_elo",label:"Cart\u00e3o de cr\u00e9dito Elo"},{id:10,value:"cartao_credito_cabal",label:"Cart\u00e3o de cr\u00e9dito Cabal"},{id:11,value:"cartao_credito_hipercard",label:"Cart\u00e3o de cr\u00e9dito Hipercard"},{id:12,value:"cartao_credito_diners",label:"Cart\u00e3o de cr\u00e9dito Diners"},{id:13,value:"cartao_credito_americanexpress",label:"Cart\u00e3o de cr\u00e9dito American Express"},{id:14,value:"cartao_sodexo_refeicao",
label:"Cart\u00e3o Sodexo Refei\u00e7\u00e3o"},{id:15,value:"cartao_sodexo_alimentacao",label:"Cart\u00e3o Sodexo Alimenta\u00e7\u00e3o"},{id:16,value:"cartao_alelo_refeicao",label:"Cart\u00e3o Alelo Refei\u00e7\u00e3o"},{id:17,value:"cartao_alelo_alimentacao",label:"Cart\u00e3o Alelo Alimenta\u00e7\u00e3o"},{id:18,value:"cartao_ticket_restaurante",label:"Cart\u00e3o Ticket Restaurante"}],campos_endereco="#id_endereco #id_numero #id_complemento #id_referencia #id_nome #id_cidade #id_bairro #id_pais_id #id_cidade #id_estado".split(" ");
function hideEndereco(){for(var a in campos_endereco)$(campos_endereco[a]).parent().parent().fadeOut();$(".formEndereco-conteiner > hr").fadeOut()}function showEndereco(){for(var a in campos_endereco)$(campos_endereco[a]).parent().parent().fadeIn();$(".formEndereco-conteiner > hr").fadeIn()}function selecionarEnvioUnico(){$("#formas-envio-wrapper.accordion").each(function(){1===$(this).find(".accordion-group:visible").length&&$(this).find(".accordion-group:visible label").click()})}
function preencheCampoEndereco(a,b){"id_cep"===b.attr("id")?(b=$("#id_endereco"),a.logradouro?(address=a.logradouro,b.val(address).attr("readonly","readonly").blur(),b.data("autocompleted",!0)):(b.data("autocompleted")&&(b.val(""),b.data("autocompleted",!1)),b.removeAttr("readonly")),b=$("#id_bairro"),a.bairro?(b.val(a.bairro).attr("readonly","readonly").blur(),b.data("autocompleted",!0)):(b.data("autocompleted")&&(b.val(""),b.data("autocompleted",!1)),b.removeAttr("readonly")),b=$("#id_cidade"),
a.cidade?(b.val(a.cidade).attr("readonly","readonly").blur(),b.data("autocompleted",!0)):(b.data("autocompleted")&&(b.val(""),b.data("autocompleted",!1)),b.removeAttr("readonly")),b=$("#id_estado"),a.estado?(b.find('option[value="'+a.estado+'"]').prop("selected",!0),b.attr("readonly","readonly").blur(),b.data("autocompleted",!0)):(b.data("autocompleted")&&b.data("autocompleted",!1),b.removeAttr("readonly"))):(a.logradouro?(address=a.logradouro,b.parents(".pagamento_selecao_info").find(".cartao_endereco_rua").val(address)):
b.parents(".pagamento_selecao_info").find(".cartao_endereco_rua").val(""),a.bairro?b.parents(".pagamento_selecao_info").find(".cartao_endereco_bairro").val(a.bairro):b.parents(".pagamento_selecao_info").find(".cartao_endereco_bairro").val(""),a.cidade?b.parents(".pagamento_selecao_info").find(".cartao_endereco_cidade").val(a.cidade):b.parents(".pagamento_selecao_info").find(".cartao_endereco_cidade").val(""),a.estado&&b.parents(".pagamento_selecao_info").find('.cartao_endereco_estado option[value="'+
a.estado+'"]').prop("selected",!0))}function calcularFrete(a,b){var c={data:{cep:a},dataType:"json",type:"get",success:function(d){preencheCampoEndereco(d,b)},error:function(){preencheCampoEndereco({},b)},ttl:3600};endpoint_api="//api.awsli.com.br/v2/cep";$.ajax(endpoint_api,c);"id_cep"===b.attr("id")&&($.cookie("cep",a,{expires:7,path:"/"}),atualizarEnvio())}
function getCepBlur(a){a=$(this).val().replace(/[^0-9]+/g,"");for(var b=$(this),c="",d=0;d<a.length;++d){var e=a.charAt(d);("0">e||"9"<e)&&""!==e||(c+=e)}c&&calcularFrete(a,b)}function getCep(a){a=$(this).val().replace(/[^0-9]+/g,"");for(var b=$(this),c="",d=0;d<a.length;++d){var e=a.charAt(d);("0">e||"9"<e)&&""!==e||(c+=e)}8<=c.length&&calcularFrete(a,b)}var frete_gratis=!1;"Frete gr\u00e1tis"==$("[data-cupom-codigo]").text()&&(frete_gratis=!0);
function aplicarCupom(){var a=$("#inputCupom").val(),b=0;if(!a)return 0;$.getJSON("/carrinho/cupom/validar.json",{cupom:a},function(c){if(c.error)return $("#inputCupom").val(""),$("#alertError span").html(c.error),$("#alertError").show(),0<$("#inputCupom").length&&$.get("/carrinho/cupom/remover",{cupom:a},function(){alert(c.error+" Seu cupom ser\u00e1 removido, para adicion\u00e1-lo novamente, v\u00e1 para o carrinho.");document.location.reload(!0)}),!1;$("#alertError").hide();$("#inputCupom").attr("readonly",
"readonly");if("fixo"==c.type||"porcentagem"==c.type)b=c.value,$("#cupomResultado").parent().parent().prev().find(".hide").show(),c.applyToTotal||"frete_gratis"==c.type?$("#cupomResultado").html('<strong class="titulo cor-principal">R$ '+formatar_decimal_br(c.discountValue)+"</strong>"):$("#cupomResultado").html('<strong class="titulo cor-principal">R$ '+formatar_decimal_br(c.discountValue)+'</strong><small class="muted">(frete n\u00e3o incluso)</small>');"frete_gratis"==c.type&&(frete_gratis=!0,
$("#cupomResultado").html("<strong>Frete gr\u00e1tis</strong>"));$("#cupomResultado").attr("data-cupom-desconto",b);$("#cupomResultado").trigger("carrinho.desconto.valor_alterado")})}var timeoutSelecionarEnvioUnico;
function carregarFormasEnvioCheckout(a,b){var c;if(8>a.length&&is_cliente_anonimo){var d=$("input.endereco-principal:checked").val();d&&"0"!=d&&(c=d)}$(".formEndereco-conteiner:eq(0)").is(":visible")?$(".formEndereco-conteiner:eq(0)").addClass("spinner"):$("#formularioEndereco").addClass("loading");$("#formasEnvio input[name=forma_envio]").prop("disabled",!0);$.getJSON("/checkout/frete",{cep:a,endereco_id:c},function(e){if(Object.keys(e).length)$(".envio-erro").hide();else{$(".envio-preco").html("");
$(".envio-prazo-entrega").html("");$(".forma-envio").removeClass("active");$(".forma-envio input[type=radio]").removeAttr("checked");var h=$("#id_cep").val();0>=h.length&&($(".envio-erro").html("CEP n\u00e3o informado."),$(".envio-erro").show())}if(e&&0<e.length){if(is_cliente_anonimo&&"0"==$("input.endereco-principal:checked").val())return;$("#formasEnvio").stop().slideDown();$(".forma-envio").hide();$(".forma-envio").addClass("indisponivel");$("#formas-envio-wrapper").html("");$.each(e,function(m,
g){valor=g.price;valor=frete_gratis&&"frete_gratis"==e.code?"0,00":formatar_decimal_br(valor);m=1==g.deliveryTime?g.deliveryTime+" dia":g.deliveryTime+" dias";"Retirar pessoalmente"===g.name?g.name="Retirada":"mercadoenvios_api"==g.type&&(g.name=g.name.replace("MercadoEnvios ",""));div='<div class="accordion-group :code forma-envio hide" id="envio:id-:code" data-id=":id" data-nome=":name" data-code=":code"><label for="formaEnvio:id-:code" class="accordion-heading :name"><span class="radio-conteiner"><input type="radio" name="forma_envio" value=":id" id="formaEnvio:id-:code" ';
g.id==ENVIO_ESCOLHIDO&&g.code==ENVIO_ESCOLHIDO_CODE&&(div+='checked="checked" ');div+='data-codigo=":code" data-preco=":price" /></span><span class="forma-conteiner"><span class="helper"></span><div class="text-content"><span class="cor-secundaria"><span class="cor-principal envio-preco"></span><b class="envio-prazo-entrega"></b></span></div><span class="envio-nome cor-secundaria" id="envio-nome-:id">';div+=g.name;div+="</span></span></label></div>";div=div.replace(/:id/g,g.id).replace(/:code/g,g.code).replace(/:name/g,
g.name).replace(/:img/g,g.image).replace(/:price/g,g.price);$("#formas-envio-wrapper").append(div);$(".forma-envio[data-id="+g.id+"][data-code="+g.code+"]").show();$(".forma-envio[data-id="+g.id+"][data-code="+g.code+"]").removeClass("indisponivel");$(".forma-envio[data-id="+g.id+"][data-code="+g.code+"]").find(".envio-nome").html(g.name);$(".forma-envio[data-id="+g.id+"][data-code="+g.code+"]").find(".envio-preco").html("R$ "+valor);$(".forma-envio[data-id="+g.id+"][data-code="+g.code+"]").attr("data-valor",
g.price);$(".forma-envio[data-id="+g.id+"][data-code="+g.code+"]").find(".envio-prazo-entrega").html(m);$(".forma-envio[data-id="+g.id+"][data-code="+g.code+"] input[name=forma_envio]").attr("data-prazo",g.deliveryTime);g.msgErro?($(".forma-envio[data-id="+g.id+"][data-code="+g.code+"] .forma-aviso").length||$(".forma-envio[data-id="+g.id+"][data-code="+g.code+"]").append('<div class="forma-aviso hide" />'),$(".forma-envio[data-id="+g.id+"][data-code="+g.code+"] .forma-aviso").text(g.msgErro)):$(".forma-envio[data-id="+
g.id+"][data-code="+g.code+"] .forma-aviso").remove();"frete_gratis"==g.name?($(".forma-envio[data-id="+g.id+"][data-code="+g.code+"]").find("img").hide(),$(".forma-envio[data-id="+g.id+"][data-code="+g.code+"]").find(".title").show()):($(".forma-envio[data-id="+g.id+"][data-code="+g.code+"]").find("img").show(),$(".forma-envio[data-id="+g.id+"][data-code="+g.code+"]").find(".title").hide())})}else $("#formasEnvio").hide(),b?($(".envio-erro").html('<i class="icon-info-sign"></i> N\u00e3o foram encontradas formas de envio.'),
$(".envio-erro").show()):setTimeout(function(){carregarFormasEnvioCheckout(h,!0)},500);$("#exibirFormasEnvio a").click();clearTimeout(timeoutSelecionarEnvioUnico);timeoutSelecionarEnvioUnico=setTimeout(selecionarEnvioUnico,500);var k=ENVIO_ESCOLHIDO,f=ENVIO_ESCOLHIDO_CODE;if(k&&f&&0===countCepChanges){if($(".resumo-compra .tabela-carrinho .frete-preco .titulo").length){var l=$("[name=forma_envio]:checked");$(".resumo-compra .tabela-carrinho .frete-preco .titulo").text($(l).parents(".forma-envio").find(".envio-preco").text());
$(".resumo-compra .tabela-carrinho .frete-preco small").hide();$(".resumo-compra .tabela-carrinho .frete-preco .titulo").show()}calcularTotal();$("#envio"+k+"-"+f).find("label").click();770<window.innerWidth&&$(".tabela-carrinho .tr-checkout-frete, .tabela-carrinho .tr-checkout-total").slideDown();countCepChanges++}}).fail(function(){b?($(".envio-erro").html("N\u00e3o foi poss\u00edvel carregar as formas de envio. Tente novamente."),$(".envio-erro").show(),$("#formasEnvio").hide()):setTimeout(function(){carregarFormasEnvioCheckout(a,
!0)},500)}).always(function(){$(".formEndereco-conteiner:eq(0)").removeClass("spinner");$("#formularioEndereco").removeClass("loading");$("#formasEnvio input[name=forma_envio]").prop("disabled",!1)})}var countCepChanges=0;
function atualizarEnvio(){var a=$("#id_cep").val();a&&=a.replace(/[^0-9]+/g,"");if($("#id_cep").data("ultimo-cep")==a&&2<a.length)return!1;$("#id_cep").data("ultimo-cep",a);var b=$(".input-cep:first").val();b&&!a&&($("#id_cep").val(b),a=b);if(!a.length)return!1;carregarFormasEnvioCheckout(a,!1)}
function atualizarEndereco(){var a=$("input.endereco-principal:checked");a.parents(".accordion-heading.collapsed").click();a=a.val();var b="/checkout/endereco/detalhar/"+a;$("#formularioEndereco").addClass("loading");$("#formasEnvio ul").empty().removeClass("hide").addClass("loading").slideDown();$("#formasEnvio input[name=forma_envio]").prop("disabled",!0);$.getJSON(b,function(c){$.each(c,function(d,e){"nome"!=d&&$("#id_"+d).val(e);"cep"==d&&$.cookie("cep",e,{expires:7,path:"/"})});$("#formasEnvio ul").removeClass("loading");
$("#formularioEndereco").removeClass("loading");atualizarEnvio()}).always(function(){$("#formasEnvio input[name=forma_envio]").prop("disabled",!1)});"0"==a?($("#formularioEndereco .formEndereco-conteiner").find("input").not("#id_cep").val(""),a=$("#formularioEndereco .formEndereco-conteiner").find("input#id_cep"),a.val()&&(0>a.val().indexOf("-")||a.val().replace("-","")!==$.cookie("cep"))&&a.val(""),is_cliente_anonimo?(a.val(""),$("#formasEnvio").stop().slideUp(),$("#formasEnvio [name=forma_envio]:checked").prop("checked",
!1),$("#formularioEndereco .formEndereco-conteiner:not(#userNewAddressInfo)").slideDown(),$("#formularioEndereco .formEndereco-conteiner#userNewAddressInfo").slideUp(),ativarBotaoCompra()):($("#carrinho-cliente-nome").data("nome")&&0>$("#carrinho-cliente-nome").data("nome").indexOf("*")&&$("#formularioEndereco .formEndereco-conteiner").find("#id_nome").val($("#carrinho-cliente-nome").data("nome")),$("#formularioEndereco .formEndereco-conteiner").slideDown(),$("#formularioEndereco #exibirFormasEnvio").stop().animate({marginTop:"25px",
marginBottom:"15px"},400),$(".cep-modal").show(),$("#id_cep:first-child").focus(),$("#formasEnvio").stop().slideUp())):($(".cep-modal").hide(),$("#formularioEndereco .formEndereco-conteiner").slideUp(),$("#formularioEndereco #exibirFormasEnvio").stop().animate({marginTop:"0",marginBottom:"15px"},400))}function debounceFuncCall(a,b,c){var d;return function(){var e=this,h=arguments;clearTimeout(d);d=setTimeout(function(){d=null;c||a.apply(e,h)},b);c&&!d&&a.apply(e,h)}}
var ajaxRequestValor,requestValorDataOld,hasCalcularTotalQueue=!1,calcularTotal=debounceFuncCall(function(){ajaxRequestValor?hasCalcularTotalQueue=!0:calcularTotalInit()},100),calcularTotalInit=function(){var a=$("#cupomResultado").attr("data-cupom-codigo");var b=parseFloat($(".tabela-carrinho .subtotal").attr("data-float")||0);var c=$("[name=forma_pagamento]:checked").val()||null;var d=$('.li-box-payment .cartao-salvo-usuario .cartao-salvo-box input[name="cartao_salvo_opcao"]:checked').val()||null;
var e=$("[name=forma_envio]:checked").val()||null;var h=$("[name=forma_envio]:checked").data("codigo");b={envio_id:e,envio_code:h,valor_subtotal:b,cupom:a,forma_pagamento_id:c,cartao_selecionado_id:d};JSON.stringify(requestValorDataOld)!==JSON.stringify(b)&&(requestValorDataOld=jQuery.extend(!0,{},b),$(".preco-carrinho-total, .aguardar-valor").addClass("valor-loading"),$(".preco-carrinho-total").trigger("calcular_total_iniciado"),ativarBotaoCompra("disable"),$("#finalizarCompra").attr("disabled",
!0),requestCalcularTotal(b))},requestCalcularTotal=function(a){ajaxRequestValor&&(ajaxRequestValor.abort(),ajaxRequestValor=null);ajaxRequestValor=$.getJSON("/carrinho/valor/",a,function(b){if(!hasCalcularTotalQueue){alteraValorTotal(b.total);paymentMinimumValue(b);$(".valor-desconto-forma-pagamento").data("float",b.desconto_forma_pagamento);aplicarCupom();if(payment_system_card)if(b.cards&&(payment_system_card=b.cards),$("#pagamentoCartao #radio-cartao").val()){var c=$("#pagamentoCartao #radio-cartao").val(),
d=$.grep(payment_system_card,function(m,g){return m.id==c});d&&d.length&&(new exibirParcelas("#escolha-cartao #cartao_cartao_parcelas")).preencheParcelas(d[0].installments)}else $("#escolha-cartao #bandeiras-manual").is(":visible")?$("#escolha-cartao #cartao_cartao_parcelas").html('<option value="">Selecione uma bandeira</option>'):$("#escolha-cartao #cartao_cartao_parcelas").html('<option value="">Digite o n\u00famero do cart\u00e3o</option>');0<b.desconto_forma_pagamento?($(".tabela-carrinho .desconto-tr .desconto-preco .titulo").html("R$ "+
formatar_decimal_br(b.desconto_forma_pagamento)),$(".tabela-carrinho .desconto-tr").slideDown(),$(".tabela-carrinho .tr-checkout-total").slideDown()):($(".tabela-carrinho .desconto-tr").slideUp(),$(".tabela-carrinho .desconto-tr .desconto-preco .titulo").html("R$ "+formatar_decimal_br(0)));$("#cart_selected_shipping").val(b.envio_selecionado);$("#cart_selected_payment").val(b.pagamento_selecionado);19==a.forma_pagamento_id&&$("#cart_selected_payment").val(a.forma_pagamento_id);b.envio_selecionado!=
a.envio_id&&($("#exibirFormasEnvio a").click(),erroTenteNovamente("N\u00e3o foi poss\u00edvel selecionar forma de envio.<br />Tente novamente ou utilize outra op\u00e7\u00e3o. (ERRTT01)"),sendFrontLogToKibana("ERRTT01",{data:b,requestValorData:a}));b.pagamento_selecionado!=a.forma_pagamento_id&&19!=a.forma_pagamento_id&&($("#exibirFormasPagamento a").click(),erroTenteNovamente("N\u00e3o foi poss\u00edvel selecionar forma de pagamento.<br />Tente novamente ou utilize outra op\u00e7\u00e3o. (ERRTT02)"),
sendFrontLogToKibana("ERRTT02",{data:b,requestValorData:a}));if(LOJA_MODO_MOSTRAR_PRECO){d=!1;a.valor_subtotal!=b.valor_items&&($(".tabela-carrinho .subtotal").attr("data-float",b.valor_items),$(".tabela-carrinho .subtotal").attr("data-subtotal",formatar_decimal_br(b.valor_items)),$(".tabela-carrinho .subtotal strong").html("R$ "+formatar_decimal_br(b.valor_items)),d=!0);var e=b.valor_items_detalhe||[];if(e.length&&cart_items.length){e.length!==cart_items.length&&$.fancybox({type:"inline",content:'<h5 style="line-height: 25px; white-space: nowrap; text-align: center; margin: 20px 0;">Os itens no checkout foram alterados.<br />Atualize a p\u00e1gina para continuar.</h5>'});
for(var h=0;h<e.length;h++){var k=e[h];if(cart_items.some(function(m){return m.id==k.id})){var f=$(".resumo-compra .tabela-carrinho td[data-produto-id="+k.id+"]");if(f.length&&(f.attr("data-produto-quantidade")!=String(k.quantity)&&(f.attr("data-produto-quantidade",k.quantity),f.siblings(".conteiner-qtd").find("div").html(k.quantity)),f.siblings(".conteiner-preco[data-item-unit-valor]").length)){var l=k.price.sellingPrice;parseFloat(f.siblings(".conteiner-preco[data-item-unit-valor]").attr("data-item-unit-valor")||
0)!=l&&(f.siblings(".conteiner-preco[data-item-unit-valor]").attr("data-item-unit-valor",l),f.siblings(".conteiner-preco[data-item-unit-valor]").find(".preco-produto .preco-promocional").html("R$ "+formatar_decimal_br(l*k.quantity)),d=!0)}}else $.fancybox({type:"inline",content:'<h5 style="line-height: 25px; white-space: nowrap; text-align: center; margin: 20px 0;">Itens no checkout alterados.<br />Atualize a p\u00e1gina para continuar.</h5>'})}}d&&$.fancybox({type:"inline",content:'<h5 style="line-height: 25px; white-space: nowrap; text-align: center; margin: 20px 0;">Um ou mais itens tiveram altera\u00e7\u00e3o de pre\u00e7o.<br />Verifique o novo valor antes de continuar.</h5>'})}$(".preco-carrinho-total").trigger("valor_total_alterado",
b)}}).done(function(){hasCalcularTotalQueue||(ativarBotaoCompra(),$("#finalizarCompra").attr("disabled",!1))}).fail(function(b){}).always(function(b){ajaxRequestValor=null;"abort"!=b.statusText&&($(".preco-carrinho-total, .aguardar-valor").removeClass("valor-loading"),$(".preco-carrinho-total").trigger("calcular_total_concluido"));hasCalcularTotalQueue&&(hasCalcularTotalQueue=!1,calcularTotal())})};
function ativarBotaoCompra(a){"disable"!==a&&$("#formasEnvio .forma-envio input:checked").length&&$("#formasPagamento .accordion-heading input:checked").length?($("#finalizarCompra").attr("readonly",!1),$("#finalizarCompra").button("reset")):($("#finalizarCompra").attr("readonly",!0),$("#finalizarCompra").addClass("disabled"));$("#finalizarCompra").removeClass("is_loading");$("#finalizarCompra").trigger("btn_finalizar_compra_alterado")}
function alteraValorTotal(a,b){$(".preco-carrinho-total").html("R$ "+formatar_decimal_br(a));$(".preco-carrinho-total").data("float",a);b||($(".resumo-compra .total").data("total",a),$(".preco-carrinho-total").trigger("carrinho.valor_alterado"))}
function paymentMinimumValue(a){pci_total_old=pci_total;pci_total=a.pci_total;var b=0==pci_total,c=$("#formasPagamento .li-box-payment.li-box-payment-PAGAMENTOEXTERNO-19");b?($("#formasPagamento .li-box-payment").slideUp(),c.slideDown(),$("#formasPagamento .li-box-payment:not(.li-box-payment-PAGAMENTOEXTERNO-19)").find('input[name="forma_pagamento"]:checked').length&&$("#exibirFormasPagamento a").click()):(c.slideUp(),c.find('input[name="forma_pagamento"]').is(":checked")&&$("#exibirFormasPagamento a").click());
b||$.each(payment_systems,function(d,e){d="creditCard"==e.groupName?"cc":e.code+"-"+e.id;0==e.minimumValue||pci_total>=e.minimumValue?$(".li-box-payment-"+d).slideDown():($(".li-box-payment-"+d).find('input[name="forma_pagamento"]').is(":checked")&&$("#exibirFormasPagamento a").click(),$(".li-box-payment-"+d).slideUp())});pci_total>=a.minimum_value.value||b?($("#li-box-payment-minimum-value").slideUp(),$("#continueShopping").slideUp(),$("#finalizarCompra").slideDown(),0==$('input[name="forma_pagamento"]:checked').length&&
pci_total_old!=pci_total&&selecionar_pagamento_padrao()):($(".li-box-payment-minimum-value-left").text("R$"+formatar_decimal_br(a.minimum_value.value-pci_total)),$("#li-box-payment-minimum-value").slideDown(),$("#continueShopping").slideDown(),$("#finalizarCompra").slideUp())}
function alertToModal(){$(".alert-geral").length&&$(".alert-geral").is(":visible")&&$.mostraAlerta({type:$(".alert-geral").data("type"),message:'<span style="margin-top: 10px; font-size: 14px; line-height: 20px;">'+$(".alert-geral").find("*").remove().end().text()+"</span>",closeOthers:!0})}
function cardPlaceholder(){placeholder_card={};$(".placeholder-card").each(function(){var a=$(this).data("code");placeholder_card[a]=new Card({form:"#escolha-"+a,container:"."+a+"-placeholder-card",formSelectors:{numberInput:"."+a+"_cartao_numero",expiryInput:"."+a+"_cartao_data_expiracao",cvcInput:"."+a+"_cartao_cvv",nameInput:"."+a+"_cartao_nome"},messages:{monthYear:"mm/aa"},placeholders:{name:"Nome Completo"}})})}
function possuiCampoVazio(){var a=!1;$("#formRecaptcha #g-recaptcha-response").length&&!$("#formRecaptcha #g-recaptcha-response").val()&&(a=!0,"undefined"!==typeof grecaptcha&&grecaptcha.reset());$("#userExtraInfo").length&&($("#formularioCheckout .dados-cadastro .control-group.required .controls input").each(function(){if("PJ"==$("#id_tipo").val()){if("cpf"==$(this).attr("name")||"data_nascimento"==$(this).attr("name"))return}else if("cnpj"==$(this).attr("name")||"razao_social"==$(this).attr("name"))return;
""===this.value&&(a=!0,$(this).focus());$(this).parents(".control-group.required.error:visible").length&&(a=!0,$(this).focus())}),$("#formularioCheckout .dados-cadastro .control-group.parent_div_id_telefone_principal .controls input").each(function(){$(this).parents(".control-group.parent_div_id_telefone_principal.error:visible").length&&(a=!0,$(this).focus())}),""===$("#formularioCheckout .dados-cadastro .control-group.required #id_sexo").val()&&"PJ"!==$("#id_tipo").val()&&(a=!0,$("#formularioCheckout .dados-cadastro .control-group.required #id_sexo").parent().parent().addClass("erro error")));
$("#formularioEndereco #userNewAddressInfo:visible").length&&$("#formularioEndereco #userNewAddressInfo .control-group.required .controls input").each(function(){""===this.value&&(a=!0,$(this).focus());$(this).parents(".control-group.required.error:visible").length&&(a=!0,$(this).focus())});""===$("#formularioCheckout #formularioObservacao.required textarea").val()&&(a=!0,$("#formularioCheckout #formularioObservacao.required textarea").focus().parent().addClass("erro error"));$("#id_politica_privacidade").length&&
!$("#id_politica_privacidade").is(":checked")&&($("#formularioCheckout #id_politica_privacidade").change(),a=!0);return a}function validateExpiryDate(a){var b=new Date,c=b.getFullYear()-2E3;b=b.getMonth()+1;return 4!==a.replace(/\D/g,"").length||2!==a.indexOf("/")||12<a.substring(0,2)||a.substring(3,5)<c||a.substring(3,5)>c+20||a.substring(3,5)==c&&a.substring(0,2)<b?!1:!0}
function maskExpiryDate(){var a=$(this),b=a.val();2===b.length&&setTimeout(function(){2!==b.indexOf("/")&&a.val(b+"/")},300)}
function coletarDadosPagamento(){var a=!0,b=$("#formasPagamento input[name=forma_pagamento]:checked").parents(".pagamento_selecao_conteiner"),c=b.find(".cartao_dados_numero"),d=b.find(".cartao_dados_expiracao"),e=b.find(".cartao_dados_nome"),h=b.find(".cartao_dados_cvv"),k=b.find(".cartao_dados_parcelas"),f=b.find(".cartao_dados_titular_check"),l=b.find(".cartao_endereco_check"),m=b.find('.cartao-salvo-usuario input[name="cartao_salvo_opcao"]'),g=b.find('.cartao-salvo-usuario input[name="cartao_salvo_opcao"]:checked');
1<m.length&&!m.is(":checked")&&(a=!1);"novo"===g.val()&&(!c.val()||13>c.val().replace(/\D/g,"").length?(c.parents(".control-group").addClass("erro error"),a=!1):(c.parents(".control-group").removeClass("erro error"),token_data[0].cardNumber=c.val().replace(/\D/g,"")),d.val()&&validateExpiryDate(d.val())?(d.parents(".control-group").removeClass("erro error"),token_data[0].expiryDate=d.val()):(d.parents(".control-group").addClass("erro error"),a=!1),!e.val()||0>e.val().trim().indexOf(" ")?(e.parents(".control-group").addClass("erro error"),
a=!1):(e.parents(".control-group").removeClass("erro error"),token_data[0].cardHolder=e.val(),$("#payment_client_name").val(token_data[0].cardHolder)));!h.val()||3>h.val().replace(/\D/g,"").length?(h.parents(".control-group").addClass("erro error"),a=!1):(h.parents(".control-group").removeClass("erro error"),token_data[0].csc=h.val());k.val()?(k.parents(".control-group").removeClass("erro error"),$("#payment_installments").val(k.val())):(k.parents(".control-group").addClass("erro error"),a=!1);if(f.is(":checked")){c=
b.find(".cartao_dados_cpf");d=b.find(".cartao_dados_nascimento");e=b.find(".cartao_dados_telefone");(h=c.val().replace(/\.|-/gi,""))&&validateCPF(h)?(c.parents(".control-group").removeClass("erro error"),token_data[0].document=c.val().replace(/\D/g,""),token_data[0].documentType="CPF"):(c.parents(".control-group").addClass("erro error"),a=!1);if(d.val())try{$.datepicker.parseDate("dd/mm/yy",d.val()),d.parents(".control-group").removeClass("erro error")}catch(n){d.parents(".control-group").addClass("erro error"),
a=!1}else d.parents(".control-group").addClass("erro error"),a=!1;e.val()?e.parents(".control-group").removeClass("erro error"):(e.parents(".control-group").addClass("erro error"),a=!1);user_data.dados_cobranca=!0;$("#payment_client_document").val(token_data[0].document);$("#payment_client_birthday").val(d.val());$("#payment_client_phone").val(e.val())}else user_data.dados_cobranca=!1,$("#payment_client_document").val(""),$("#payment_client_birthday").val(""),$("#payment_client_phone").val("");l.is(":checked")?
(l=b.find(".cartao_endereco_cep"),c=b.find(".cartao_endereco_rua"),d=b.find(".cartao_endereco_numero"),e=b.find(".cartao_endereco_compl"),h=b.find(".cartao_endereco_bairro"),k=b.find(".cartao_endereco_cidade"),f=b.find(".cartao_endereco_estado"),!l.val()||8>l.val().replace(/\D/g,"").length?(l.parents(".control-group").addClass("erro error"),a=!1):(l.parents(".control-group").removeClass("erro error"),token_data[0].address.postalCode=l.val()),c.val()?(c.parents(".control-group").removeClass("erro error"),
token_data[0].address.street=c.val()):(c.parents(".control-group").addClass("erro error"),a=!1),d.val()?(d.parents(".control-group").removeClass("erro error"),token_data[0].address.number=d.val()):(d.parents(".control-group").addClass("erro error"),a=!1),e.val()&&(token_data[0].address.complement=e.val()),h.val()?(h.parents(".control-group").removeClass("erro error"),token_data[0].address.neighborhood=h.val()):(h.parents(".control-group").addClass("erro error"),a=!1),k.val()?(k.parents(".control-group").removeClass("erro error"),
token_data[0].address.city=k.val()):(k.parents(".control-group").addClass("erro error"),a=!1),f.val()?(f.parents(".control-group").removeClass("erro error"),token_data[0].address.state=f.val()):(f.parents(".control-group").addClass("erro error"),a=!1),user_data.endereco_cobranca=!0,$("#payment_address_postalCode").val(token_data[0].address.postalCode),$("#payment_address_street").val(token_data[0].address.street),$("#payment_address_number").val(token_data[0].address.number),$("#payment_address_complement").val(token_data[0].address.complement),
$("#payment_address_neighborhood").val(token_data[0].address.neighborhood),$("#payment_address_city").val(token_data[0].address.city),$("#payment_address_state").val(token_data[0].address.state)):(user_data.endereco_cobranca=!1,$("#payment_address_postalCode").val(""),$("#payment_address_street").val(""),$("#payment_address_number").val(""),$("#payment_address_complement").val(""),$("#payment_address_neighborhood").val(""),$("#payment_address_city").val(""),$("#payment_address_state").val(""));token_data[0].paymentSystem=
b.find("[name=forma_pagamento]").data("nome-gateway");$("#payment_address_active").val(user_data.endereco_cobranca);$("#payment_client_active").val(user_data.dados_cobranca);return a}
var resize=function(){var a=$("#formas-pagamento-wrapper");if(0==a.find(".placeholder-card").length)return!1;a=a.width();var b=1;390>a&&(b=a/390);$(".jp-card-container").each(function(){$(this).css("transform","scale("+b+")");100>$(this)[0].getBoundingClientRect().height?$(this).parent(".placeholder-card").height(148):$(this).parent(".placeholder-card").height($(this)[0].getBoundingClientRect().height);$(this).parent(".placeholder-card").width($(this)[0].getBoundingClientRect().width)})};
function selecionar_pagamento_padrao(){$("#formasPagamento.accordion, #formas-envio-wrapper.accordion").each(function(){1===$(this).find(".accordion-group").length&&$(this).find(".accordion-group .accordion-heading input").click()});if($(".formas.pagamento .forma-pagamento-padrao").length){var a=$(".formas.pagamento .forma-pagamento-padrao[value=cartao]").length?$(".formas.pagamento .forma-pagamento-padrao[value=cartao]").first().val():$(".formas.pagamento .forma-pagamento-padrao").first().val();
$("input[name=forma_pagamento]").each(function(){if($(this).data("code")===a&&"none"!=$(this).parents(".li-box-payment").css("display")&&$(this).parents(".li-box-payment").data("minimum-value")<=pci_total)return $(this).click(),!1})}}
function atualizarDadosCliente(){var a=$("#id_endereco").val();token_data[0].address.street&&token_data[0].address.street==a||!a||(token_data[0].address.street=a);a=$("#id_numero").val();token_data[0].address.number&&token_data[0].address.number==a||!a||(token_data[0].address.number=a);a=$("#id_complemento").val();token_data[0].address.complement&&token_data[0].address.complement==a||(token_data[0].address.complement=a);a=$("#id_bairro").val();token_data[0].address.neighborhood&&token_data[0].address.neighborhood==
a||!a||(token_data[0].address.neighborhood=a);a=$("#id_cidade").val();token_data[0].address.city&&token_data[0].address.city==a||!a||(token_data[0].address.city=a);a=$("#id_estado").val();token_data[0].address.state&&token_data[0].address.state==a||!a||(token_data[0].address.state=a);a=$("#id_cep").val();token_data[0].address.postalCode&&token_data[0].address.postalCode==a||!a||(token_data[0].address.postalCode=a);"PJ"==$("#id_tipo_usuario").val()?(token_data[0].documentType="CNPJ",a=$("#id_cnpj").val()):
(token_data[0].documentType="CPF",a=$("#id_cpf").val());token_data[0].document&&token_data[0].document==a||(a?token_data[0].document=a:(token_data[0].document=user_data.documento,token_data[0].documentType=user_data.documentoTipo))}function setPurchaseCookie(a){$.cookie(a,(new Date).toString(),{expires:1})}
function deveBloquearCompraRepetida(){for(var a=[],b=0;b<cart_items.length;b++){var c=a,d=cart_items[b];c.push.call(c,d.id.toString()+"|"+d.quantity.toString())}c={};d=$("#formularioCheckout").serializeArray();for(b=0;b<d.length;b++)c[d[b].name]=d[b].value;delete c.payment_cvv;c.cartao_cartao_numero&&(c.cartao_cartao_numero=c.cartao_cartao_numero.slice(-4));b=Sha256.hash(JSON.stringify(c));a="checkout-"+client_id+"-"+a.join("-")+"-"+b;b=$.cookie(a);if(!b)return setPurchaseCookie(a),!1;if(Math.floor((new Date-
new Date(b))/1E3/60)<SAME_PURCHASE_COOLDOWN)return!0;setPurchaseCookie(a);return!1}
function validarCheckout(a){$("#cart_selected_shipping_value").val($("#formasEnvio input[name=forma_envio]:checked").data("preco"));var b=$("#formasPagamento input[name=forma_pagamento]:checked");b.length&&-1<b.attr("id").indexOf("radio-bank-")?$("#payment_bank_id").val(b.data("bank-id")):$("#payment_bank_id").val("");if($("#formasEnvio input[name=forma_envio]:checked").length&&$("#formasEnvio input[name=forma_envio]:checked").val()===$("#cart_selected_shipping").val())if(b.length&&b.val()===$("#cart_selected_payment").val()){if(possuiCampoVazio())return $(document).trigger("li_checkout_error",
["Preencha todos os campos obrigat\u00f3rios corretamente. Caso o erro persista, recarregue a p\u00e1gina e tente novamente."]),$.fancybox({type:"inline",content:'<h5 style="line-height: 30px; white-space: nowrap; text-align: center;">Preencha todos os campos obrigat\u00f3rios corretamente.<br />Caso o erro persista, recarregue a p\u00e1gina e tente novamente.</h5>'}),!1;if("radio-cartao"===b.attr("id")&&!coletarDadosPagamento())return $(document).trigger("li_checkout_error",["Preencha os dados de pagamento corretamente"]),
$.fancybox({type:"inline",content:'<h5 style="line-height: 70px; white-space: nowrap;">Preencha os dados de pagamento corretamente</h5>'}),!1;if(a&&deveBloquearCompraRepetida())return $(document).trigger("li_checkout_error",["Voc\u00ea tentou fazer uma compra igual a esta nos \u00faltimos minutos. Para evitar duplicar o seu pedido, confira se ele j\u00e1 foi emitido na tela de pedidos e, caso contr\u00e1rio, tente novamente em "+SAME_PURCHASE_COOLDOWN+" minutos"]),$.fancybox({type:"inline",content:'<h5 style="line-height: 30px; white-space: nowrap;">Voc\u00ea tentou fazer uma compra igual a esta nos \u00faltimos minutos.<br />Para evitar duplicar o seu pedido, confira se ele j\u00e1 foi emitido na tela de pedidos e, caso contr\u00e1rio, tente novamente em '+
SAME_PURCHASE_COOLDOWN+" minutos</h5>"}),!1}else return $(document).trigger("li_checkout_error",["Selecione uma forma de pagamento"]),$.fancybox({type:"inline",content:'<h5 style="line-height: 70px; white-space: nowrap;">Selecione uma forma de pagamento</h5>'}),b.length&&$("#exibirFormasPagamento a").click(),!1;else return $(document).trigger("li_checkout_error",["Selecione uma forma de envio"]),$.fancybox({type:"inline",content:'<h5 style="line-height: 70px; white-space: nowrap;">Selecione uma forma de envio</h5>'}),
$("#formasEnvio input[name=forma_envio]:checked").length&&$("#exibirFormasEnvio a").click(),!1;return!0}function erroTenteNovamente(a){a||="Falha ao realizar pedido. Tente novamente.";window.stop();ativarBotaoCompra();$(document).trigger("li_checkout_error",[a.replace("<br />"," ")]);$.fancybox({type:"inline",content:'<div style="display: flex;align-items: center;min-height: 100%;text-align: center;"><h5>'+a+"</h5></div>"})}
function submitCheckoutForm(a){a&&(a.paymentName&&(requestFingerPrint(a.paymentName),$("#payment_system_name").val(a.paymentName)),a.paymentId&&$("#payment_system_id").val(a.paymentId),a.token&&$("#payment_token").val(a.token),a.bin&&$("#payment_bin").val(a.bin),a.lastDigits&&$("#payment_last_digits").val(a.lastDigits),a.cvv&&$("#payment_cvv").val(a.cvv),a.sessionId&&$("#payment_session_id").val(a.sessionId));mustHaveFingerPrint&&!$("#payment_fingerprint").val()?(console.log("Falha ao gerar FingerPrint"),
erroTenteNovamente("N\u00e3o foi poss\u00edvel validar o cart\u00e3o digitado.<br />Tente novamente ou utilize outro cart\u00e3o. (ERRFP01)"),sendFrontLogToKibana("ERRFP01")):$("#formularioCheckout").submit()}
function proxyRequestCardToken(){proxy_pci_domain&&proxy_pci_public_key&&token_data&&token_data.length||(console.log("Missing public key or token data"),erroTenteNovamente("N\u00e3o foi poss\u00edvel validar o cart\u00e3o digitado.<br />Tente novamente ou utilize outro cart\u00e3o. (ERRLI01)"),sendFrontLogToKibana("ERRLI01",{proxy_pci_domain,proxy_pci_public_key,token_data:!!token_data}));var a=token_data[0],b={number:a.cardNumber,holderName:a.cardHolder,expMonth:a.expiryDate.split("/")[0],expYear:"20"+
a.expiryDate.split("/")[1]},c={number:a.csc},d={url:proxy_pci_domain+"/v1",method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","x-pp-public-key":proxy_pci_public_key},dataType:"json"},e=Object.assign({},d);e.url+="/cards";e.data=JSON.stringify(b);b=Object.assign({},d);b.url+="/cvvs";b.data=JSON.stringify(c);var h;c=$('.li-box-payment .cartao-salvo-usuario .cartao-salvo-box input[name="cartao_salvo_opcao"]:checked');c.length&&"novo"!==c.val()&&c.data("token")&&(h=[{token:c.data("token"),
number:c.data("bin")+" "+c.data("last-digits"),id:c.val()},"success"]);$.when(h||$.ajax(e),$.ajax(b)).then(function(k,f){try{k[0].token&&f[0].token?($("#payment_system_id").val(""),$("#payment_session_name").val(""),submitCheckoutForm({paymentName:a.paymentSystem,sessionId:k[0].id,token:k[0].token,bin:k[0].number.slice(0,6),lastDigits:k[0].number.slice(-4),cvv:f[0].token})):(console.log("Card Token Error",k,f),erroTenteNovamente("N\u00e3o foi poss\u00edvel validar o cart\u00e3o digitado.<br />Tente novamente ou utilize outro cart\u00e3o. (ERRLI03)"),
sendFrontLogToKibana("ERRLI03",{result_card:k,result_cvv:f}))}catch(l){console.log("Card Token Error",l),erroTenteNovamente("N\u00e3o foi poss\u00edvel validar o cart\u00e3o digitado.<br />Tente novamente ou utilize outro cart\u00e3o. (ERRLI03.1)"),k=JSON.stringify(l,Object.getOwnPropertyNames(l)),sendFrontLogToKibana("ERRLI03.1",k)}},function(k){console.log("Card Token Error",k);erroTenteNovamente("N\u00e3o foi poss\u00edvel validar o cart\u00e3o digitado.<br />Tente novamente ou utilize outro cart\u00e3o. (ERRLI04)");
sendFrontLogToKibana("ERRLI04",k)})}var mustHaveFingerPrint=!1;
function requestFingerPrint(a){var b=$.grep(payment_system_card,function(c,d){return proxy_transparente_iniciado?"pagali-cartao"===c.code||c.code.startsWith("proxy")&&c.code.endsWith("cartao"):c.name==a});b&&b.length&&("pagseguro"===b[0].code||"pagsegurov2"===b[0].code?(mustHaveFingerPrint=!0,pagseguro_iniciado&&"undefined"!==typeof PagSeguroDirectPayment?(b="pagsegurov2"===b[0].code?"ps-"+PagSeguroDirectPayment.getSenderHash():PagSeguroDirectPayment.getSenderHash(),$("#payment_fingerprint").val(b)):
iniciarPagseguroTransparente()):"mercadopagov1"===b[0].code?(mustHaveFingerPrint=!0,mercadopago_iniciado&&$("#deviceId").val()?$("#payment_fingerprint").val($("#deviceId").val()):iniciarMercadoPagoTransparente()):"proxy-cielo-v1-cartao"===b[0].code?(mustHaveFingerPrint=!0,cielo_iniciado&&$("#payment_fingerprint").val()||iniciarCieloTransparente()):"proxy-mercadopago-v1-cartao"===b[0].code&&(mustHaveFingerPrint=!0,mercadopago_iniciado&&$("#deviceId").val()?$("#payment_fingerprint").val($("#deviceId").val()):
iniciarMercadoPagoTransparente()))}function requestFingerPrintBoleto(){mustHaveFingerPrint=!0;if(pagseguro_iniciado&&"undefined"!==typeof PagSeguroDirectPayment){var a="ps-"+PagSeguroDirectPayment.getSenderHash();$("#payment_fingerprint").val(a);$("#payment_fingerprint").val()?submitCheckoutForm():(console.log("Falha ao gerar FingerPrint"),erroTenteNovamente())}else console.log("Falha ao gerar FingerPrint"),erroTenteNovamente(),iniciarPagseguroTransparente()}
function exibirParcelas(a){var b=$(a);this._renderizaOption=function(c){var d=c.value,e=c.interestRate;c=c.quantity;var h=d.toFixed(2);d=(c*d).toFixed(2);return['<option data-juros="{}" '.replace("{}",e),'data-valor-parcela="{}" '.replace("{}",h),'data-valor-total="{}" '.replace("{}",d),'value="{}">'.replace("{}",c),"{}x de R$ {}".replace("{}",c).replace("{}",h.replace(".",",").replace(/\d(?=(\d{3})+,)/g,"$&.")),e?"":" sem juros","</option>"].join("")};this.preencheParcelas=function(c){var d=[];if(c&&
c.length){d.push('<option value="">Escolha...</option>');for(var e=0;e<c.length;e++)d.push(this._renderizaOption(c[e]))}else d.push('<option value="">Nenhum parcelamento disponivel</option>');b.html(d.join(""))}}
function selecionarBandeiraCartao(a){if(a)$("#pagamentoCartao #radio-cartao").val(a.id),$("#pagamentoCartao #radio-cartao").data("nome-gateway",a.name);else if(resetBandeiraSelecionada(),!$("#escolha-cartao #bandeiras-manual").is(":visible")||!$("#escolha-cartao #bandeiras-manual .bandeiras-pagamento li.active").length){$("#escolha-cartao #cartao_cartao_parcelas").html('<option value="">Selecione uma bandeira</option>');if(proxy_transparente_iniciado)$("#escolha-cartao #bandeiras-manual .bandeiras-pagamento li").removeClass("hide");
else for(i=0;i<payment_system_card.length;i++)a=payment_system_card[i],a.name&&$('#escolha-cartao #bandeiras-manual .bandeiras-pagamento li[data-name="'+a.name+'"]').removeClass("hide");$("#escolha-cartao #bandeiras-manual").stop().slideDown()}calcularTotal()}var bandeiraSelecionadaManualmente=!1;
function identificarBandeiraCartao(a){if(payment_system_card){if(proxy_transparente_iniciado){var b=payment_system_card[0];proxySetCardBrand(a);var c=b}else for(i=0;i<payment_system_card.length;i++)if(b=payment_system_card[i],b.validator&&b.validator.regex)try{(new RegExp(b.validator.regex)).test(a)&&(c=b)}catch(d){console.log(d)}c&&($("#escolha-cartao #bandeiras-manual").stop().slideUp(),proxy_transparente_iniciado||(bandeiraSelecionadaManualmente=!1));proxy_transparente_iniciado||selecionarBandeiraCartao(c)}}
function exibirPlaceholderCartao(a){$(".cartao-placeholder-card").find(".jp-card").removeClass(function(b,c){return(c.match(/(^|\s)jp-card-\S+/g)||[]).join(" ")});a&&$(".cartao-placeholder-card").find(".jp-card").addClass("jp-card-identified").addClass(a)}
function resetBandeiraSelecionada(){$("#pagamentoCartao #radio-cartao").val("");$("#pagamentoCartao #radio-cartao").data("nome-gateway",null);$("#escolha-cartao #cartao_cartao_parcelas").html('<option value="">Digite o n\u00famero do cart\u00e3o</option>');$("#escolha-cartao #bandeiras-manual").stop().slideUp();$("#escolha-cartao #bandeiras-manual .bandeiras-pagamento li.active").removeClass("active");setTimeout(function(){exibirPlaceholderCartao();$("#formularioCheckout #escolha-cartao .cartao_dados_numero").removeClass("identified");
$("#formularioCheckout #escolha-cartao .cartao_dados_numero").removeClass(Payment.getAllCardTypes().join(" "))},1)}function validateCPF(a){if(11!==a.length||!Array.from(a).filter(function(c){return c!==a[0]}).length)return!1;var b=0;for(i=1;9>=i;i++)b+=parseInt(a.substring(i-1,i))*(11-i);b=10*b%11;if(10==b||11==b)b=0;if(b!=parseInt(a.substring(9,10)))return!1;b=0;for(i=1;10>=i;i++)b+=parseInt(a.substring(i-1,i))*(12-i);b=10*b%11;if(10==b||11==b)b=0;return b!=parseInt(a.substring(10,11))?!1:!0}
function validateDDD(a){return 0<="11 12 13 14 15 16 17 18 19 21 22 24 27 28 31 32 33 34 35 37 38 41 42 43 44 45 46 47 48 49 51 53 54 55 61 62 63 64 65 66 67 68 69 71 73 74 75 77 79 81 82 83 84 85 86 87 88 89 91 92 93 94 95 96 97 98 99".split(" ").indexOf(a)}var iconBandeirasDisponiveis={mastercard:"mastercard",visa:"visa",amex:"amex",diners:"diners",elo:"elo",aura:"aura",discover:"discover",hipercard:"hipercard",jcb:"jcb"};
function proxySetCardBrand(a,b){if(a&&!(6>a.length)){var c=!!b,d=a.substring(0,6);$.getJSON("https://api.mundipagg.com/bin/v1/"+d,function(e){if(e&&e.brandName&&"aura"!==e.brand)if(c)(e=iconBandeirasDisponiveis[e.brand])&&$('.li-box-payment .cartao-salvo-usuario .cartao-salvo-radio input[data-bin="'+d+'"]').parent(".cartao-salvo-radio").find(".icone-pagamento").removeClass("other-card").addClass(e);else{var h=payment_system_card[0];if("pagali-cartao"===h.code||h.code.startsWith("proxy-")&&h.code.endsWith("-cartao")){payment_system_card[0].name=
e.brandName;bandeiraSelecionadaManualmente=!1;selecionarBandeiraCartao(payment_system_card[0]);return}}c||selecionarBandeiraCartao()}).fail(function(){c||selecionarBandeiraCartao()}).always(function(e){})}}
function onSavedCardChange(a){$(".li-box-payment .cartao-dados-adicionais").slideDown();if("novo"===$(this).val()){$(".li-box-payment .cartao-cadastrar-novo").slideDown();$("#escolha-cartao .group_cartao_salvar").slideDown();try{resize()}catch(b){}}else $(".li-box-payment .cartao-cadastrar-novo").slideUp(),$("#escolha-cartao .group_cartao_salvar").slideUp(),(a=$(this).data("number"))&&(a=a.replace(/X/g,"0")),identificarBandeiraCartao(a),$(".li-box-payment-cc #escolha-cartao input.cartao_dados_cvv").focus()}
function fillUserSavedCard(a){for(var b=0;b<a.length;b++){var c=a[b];if(c.token){var d=c.expMonth+"/"+c.expYear.slice(-2);d='      <label class="cartao-salvo-box '+(0>d.indexOf("*")&&!validateExpiryDate(d)?"cartao-salvo-expired":"")+'">        <span class="cartao-salvo-radio">          <input type="radio" name="cartao_salvo_opcao" value="'+c.id+'" data-token="'+c.token+'" data-bin="'+c.bin+'" data-last-digits="'+c.last_digits+'" data-number="'+c.number+'" />          <span class="bandeiras-pagamento">            <i class="icone-pagamento other-card" title=""></i>          </span>        </span>        <span class="cartao-salvo-detalhes">          <span class="cartao-salvo-numero">            &bull;&bull;&bull;&bull; &bull;&bull;&bull;&bull; &bull;&bull;&bull;&bull; '+
c.last_digits+'</span>          <span class="cartao-salvo-nome">'+c.holderName+'</span>          <span class="cartao-salvo-exp">Exp. '+d+"</span>        </span>      </label>";$(".li-box-payment .cartao-salvo-usuario .cartao-salvo-itens").append(d);proxySetCardBrand(c.bin,c.id)}}}
function checkUserHasSavedCard(){"undefined"!==typeof proxy_pci_saved_cards_url&&proxy_pci_saved_cards_url&&$.ajax({url:proxy_pci_saved_cards_url,method:"GET",headers:{"content-type":"application/json",accept:"application/json"},dataType:"json",success:function(a){a&&Array.isArray(a)&&a.length&&(fillUserSavedCard(a),$(".li-box-payment .cartao-cadastrar-novo, .li-box-payment .cartao-dados-adicionais").slideUp("fast"),$(".li-box-payment .cartao-salvo-usuario").slideDown("fast"),$('.li-box-payment .cartao-salvo-usuario .cartao-salvo-box .cartao-salvo-radio input[name="cartao_salvo_opcao"]').prop("checked",
!1),$('.li-box-payment .cartao-salvo-usuario .cartao-salvo-box .cartao-salvo-radio input[name="cartao_salvo_opcao"]').change(onSavedCardChange))},error:function(a){console.log("Falha ao buscar cart\u00f5es do usuario",a)}})}var currentCardValueUsed=null;
$(function(){function a(f){var l=!1;d&&(d.abort(),d=null);d=$.ajax({url:"/conta/verificar_cpf",dataType:"json",data:{cpf:f},success:function(m){"ERRO"==m.situacao&&($("#id_cpf").parents(".control-group").addClass("error"),$("#id_cpf").next(".help-block").html('CPF j\u00e1 cadastrado.<br /><a href="javascript:exibirLogin();"><strong>Efetuar login</strong></a>').slideDown(),l=!0)},complete:function(m){d=null}});return l}alertToModal();$("#linhaScroll").length&&$("html, body").animate({scrollTop:$("#linhaScroll").offset().top-
15},1500);aplicarCupom();cardPlaceholder();payment_system_card&&payment_system_card.length&&iniciarTransparente();payment_system_bank&&payment_system_bank.length&&(pagseguro_iniciado||iniciarPagseguroTransparente());$("#id_cep, .input-cep").unbind("keyup");$("#id_cep, .input-cep").keyup(getCep);if($.cookie("cep")&&$("#id_cep").val()&&$("#id_cep").val().replace("-","")!=$.cookie("cep").replace("-","")&&0>$.cookie("cep").indexOf("*")){var b=$.cookie("cep");$("input[name=endereco_principal][data-cep="+
b+"]").length?$("input[name=endereco_principal][data-cep="+b+"]").click():($("#idEnderecoPrincipal0").click(),0>b.indexOf("-")&&(b=b.slice(0,5)+"-"+b.slice(5)),$("#id_cep").val(b).keyup())}$("input.endereco-principal:checked").length||$("#id_cep, .input-cep").keyup();$(".pagamento_selecao_conteiner .cartao_cartao_data_expiracao").keyup(maskExpiryDate);$("#id_pais_id").attr("readonly","readonly");$("input.endereco-principal").bind("change",atualizarEndereco);$("input.endereco-principal:checked").trigger("change");
var c=!1;$("input.endereco-principal").each(function(){if($("#id_cep").val()==$(this).data("cep"))return $(this).attr("checked","checked").trigger("change"),c=!0,!1});$("#id_cep").val()&&!c&&(is_cliente_anonimo?$("input.endereco-principal:checked").val()||$("input.endereco-principal").first().click():$("input.endereco-principal#idEnderecoPrincipal0").attr("checked","checked"));$("input[name=forma_pagamento]").bind("change",function(){calcularTotal();if($(this).attr("data-pagamento-banco-id")){var f=
$(this).attr("data-pagamento-banco-id");$("[name=pagamento_banco_id]").val(f)}else $("[name=pagamento_banco_id]").val("");$(".formas.pagamento .accordion-group").not($(this).parent().parent().parent()).slideUp();$(".formas.pagamento .accordion-group .mycollapse").not($(this).parent().parent().parent().find(".mycollapse")).removeClass("in");$(this).parent().parent().parent().find(".mycollapse").addClass("in");$(this).parent().parent().parent().find(".mycollapse").slideDown();"cartao"==$(this).data("code")&&
resize();1<$(".formas.pagamento .accordion-group").length&&$("#exibirFormasPagamento").slideDown();$(this).attr("data-desconto-aplicar-total")&&"False"===$(this).attr("data-desconto-aplicar-total")?$(".tabela-carrinho .desconto-tr .texto-aplicar-total").slideDown():$(".tabela-carrinho .desconto-tr .texto-aplicar-total").slideUp()});$("input.cartao_dados_titular_check").bind("change",function(){$(this).is(":checked")?$(this).parents(".pagamento_selecao_info").find(".cartao_dados_titular").stop().slideDown():
$(this).parents(".pagamento_selecao_info").find(".cartao_dados_titular").stop().slideUp()});$("input.cartao_dados_titular_check").is(":checked")&&$("input.cartao_dados_titular_check").change();$("input.cartao_endereco_check").bind("change",function(){$(this).is(":checked")?$(this).parents(".pagamento_selecao_info").find(".cartao_dados_fatura").stop().slideDown():$(this).parents(".pagamento_selecao_info").find(".cartao_dados_fatura").stop().slideUp()});$(".formas.pagamento .accordion-heading").click(function(){$(this).parent().find("input[name=forma_pagamento]").prop("checked",
!0);$(this).parent().find("input[name=forma_pagamento]").change()});$("#exibirFormasPagamento a").click(function(){$('.formas.pagamento input[name="forma_pagamento"]:checked').prop("checked",!1);$(".formas.pagamento .accordion-group").slideDown();$("#exibirFormasPagamento").slideUp();$(".formas.pagamento .accordion-heading + div.in").slideUp();calcularTotal()});$("#exibirFormasEnvio a").click(function(){$(".formas.envio .accordion-group:not(.indisponivel)").slideDown();$(".formas.envio .accordion-group.forma-envio-ativo").removeClass("forma-envio-ativo");
$("#exibirFormasEnvio").slideUp();$(".formas.envio input:checked").prop("checked",!1);$(".resumo-compra .tabela-carrinho .frete-preco .titulo").length&&($(".resumo-compra .tabela-carrinho .frete-preco small").show(),$(".resumo-compra .tabela-carrinho .frete-preco .titulo").hide());calcularTotal()});$(document).on("change","input[name=forma_envio]",function(){var f=$(this).val(),l=$("#formas-envio-wrapper").data("forma-envio");f!=l&&$("#formas-envio-wrapper").data("forma-envio",f);$("#forma_envio_code").val($(this).data("codigo"));
calcularTotal();$(".resumo-compra .tabela-carrinho .frete-preco .titulo").length&&($(".resumo-compra .tabela-carrinho .frete-preco .titulo").text($(this).parents(".forma-envio").find(".envio-preco").text()),$(".resumo-compra .tabela-carrinho .frete-preco small").hide(),$(".resumo-compra .tabela-carrinho .frete-preco .titulo").show());$(".formas.envio .accordion-group").not($(this).parent().parent().parent()).slideUp();1<$(".formas.envio .accordion-group:not(.indisponivel)").length&&$("#exibirFormasEnvio").slideDown();
$(".formas.envio .accordion-group.forma-envio-ativo").removeClass("forma-envio-ativo");$(this).parents(".accordion-group").addClass("forma-envio-ativo");"mercadoenvios_expresso"===$(this).data("codigo")||"mercadoenvios_normal"===$(this).data("codigo")?($(".formas.pagamento .accordion-group:not(.mercadopago, .disabled)").addClass("disabled disabled_mercadoenvios"),$("#exibirFormasPagamento a").click()):$(".formas.pagamento .accordion-group.disabled_mercadoenvios").removeClass("disabled disabled_mercadoenvios");
"motoboy"===$(this).data("codigo")||"retirar_pessoalmente"===$(this).data("codigo")?($(".formas.pagamento .accordion-group.entrega.disabled").removeClass("disabled"),$(".formas.pagamento .accordion-group.proxy-entrega-v1-entrega.disabled").removeClass("disabled")):($(".formas.pagamento .accordion-group.entrega:not(.disabled)").addClass("disabled"),$(".formas.pagamento .accordion-group.proxy-entrega-v1-entrega:not(.disabled)").addClass("disabled"));$(".formas.pagamento .accordion-group.entrega .accordion-heading .forma-conteiner img").length&&
("retirar_pessoalmente"===$(this).data("codigo")&&$(".formas .accordion-group.entrega .accordion-heading .forma-conteiner img").attr("src").length?($(".formas.pagamento .accordion-group.entrega .accordion-heading .forma-conteiner img").attr("src",$(".formas.pagamento .accordion-group.entrega .accordion-heading .forma-conteiner img").attr("src").replace("entrega.png","entrega-retirada.png")),$('.formas.pagamento .accordion-group.entrega .entrega-form-group label[for="id_escolher_tipo_pagamento"]').text($('.formas.pagamento .accordion-group.entrega .entrega-form-group label[for="id_escolher_tipo_pagamento"]').text().replace("entrega",
"retirada"))):($(".formas.pagamento .accordion-group.entrega .accordion-heading .forma-conteiner img").attr("src",$(".formas .accordion-group.entrega .accordion-heading .forma-conteiner img").attr("src").replace("entrega-retirada.png","entrega.png")),$('.formas.pagamento .accordion-group.entrega .entrega-form-group label[for="id_escolher_tipo_pagamento"]').text($('.formas .accordion-group.entrega .entrega-form-group label[for="id_escolher_tipo_pagamento"]').text().replace("retirada","entrega"))));
$(".formas.pagamento .accordion-group.proxy-entrega-v1-entrega .accordion-heading .forma-conteiner img").length&&("retirar_pessoalmente"===$(this).data("codigo")&&$(".formas .accordion-group.proxy-entrega-v1-entrega .accordion-heading .forma-conteiner img").attr("src").length?($(".formas.pagamento .accordion-group.proxy-entrega-v1-entrega .accordion-heading .forma-conteiner img").attr("src",$(".formas.pagamento .accordion-group.proxy-entrega-v1-entrega .accordion-heading .forma-conteiner img").attr("src").replace("proxy-entrega-v1-entrega.png",
"proxy-entrega-v1-entrega-retirada.png")),$('.formas.pagamento .accordion-group.proxy-entrega-v1-entrega .entrega-form-group label[for="id_escolher_tipo_pagamento"]').text($('.formas.pagamento .accordion-group.entrega .entrega-form-group label[for="id_escolher_tipo_pagamento"]').text().replace("entrega","retirada"))):($(".formas.pagamento .accordion-group.proxy-entrega-v1-entrega .accordion-heading .forma-conteiner img").attr("src",$(".formas .accordion-group.proxy-entrega-v1-entrega .accordion-heading .forma-conteiner img").attr("src").replace("proxy-entrega-v1-entrega-retirada.png",
"proxy-entrega-v1-entrega.png")),$('.formas.pagamento .accordion-group.proxy-entrega-v1-entrega .entrega-form-group label[for="id_escolher_tipo_pagamento"]').text($('.formas .accordion-group.proxy-entrega-v1-entrega .entrega-form-group label[for="id_escolher_tipo_pagamento"]').text().replace("retirada","entrega"))));showEndereco();""!==$("#id_endereco").val()?$("#id_numero").focus():$("#id_endereco").focus()});$("#escolha-cartao #bandeiras-manual .bandeiras-pagamento li").click(function(){$("#escolha-cartao #bandeiras-manual .bandeiras-pagamento li").removeClass("active");
$bandeiraSelecionada=$(this);var f=$.grep(payment_system_card,function(l,m){return proxy_transparente_iniciado?"pagali-cartao"===l.code||l.code.startsWith("proxy")&&l.code.endsWith("cartao"):l.name==$bandeiraSelecionada.data("name")});f&&f.length?(proxy_transparente_iniciado&&(f[0].name=$bandeiraSelecionada.data("name")),$bandeiraSelecionada.addClass("active"),bandeiraSelecionadaManualmente=!0,selecionarBandeiraCartao(f[0]),exibirPlaceholderCartao($bandeiraSelecionada.data("class"))):($(document).trigger("li_checkout_error",
["Bandeira n\u00e3o dispon\u00edvel"]),$.fancybox({type:"inline",content:'<h5 style="line-height: 70px; white-space: nowrap;">Bandeira n\u00e3o dispon\u00edvel</h5>'}))});$("#tipoCadastro li a").click(function(){var f=$(this).attr("data-value");$("#id_tipo").val(f);$("#id_tipo_usuario").val(f);"PF"===f?($("#id_nome").parent().parent().prependTo($(".campos-top")),$("input.cartao_dados_titular_check").length&&$("input.cartao_dados_titular_check").attr("readonly")&&$("input.cartao_dados_titular_check").attr("readonly",
!1).attr("onclick","")):($("#id_nome").parent().parent().prependTo($(".campos-bot")),$("input.cartao_dados_titular_check").length&&$("input.cartao_dados_titular_check").attr("checked",!0).attr("readonly",!0).attr("onclick","return false").change());$("#id_tipo").trigger("tipo_cadastro",f)});$("#tipoCadastro a#tabCadastroPessoaFisica").tab("show");"PJ"===$("#id_tipo_usuario").val()&&$("#tipoCadastro #tabCadastroPessoaJuridica").click();$("#formularioCheckout").unbind();var d,e=function(){var f=$(".email-verificacao").parents(".control-group").filter(".control-group"),
l=$("#id_email").val();if(!validateEmail(l))return!1;$.getJSON("/conta/verificar_email",{email:l,should_auth:!0},function(m){"SUCESSO"==m.situacao?(f.removeClass("error"),$(".email-verificacao").html("").slideDown()):"DESATIVADO"==m.situacao?(f.addClass("error"),$(".email-verificacao").html(m.mensagem).slideDown()):m.is_checkout_passwordless?window.location.href="/checkout":(f.addClass("error"),$(".email-verificacao").html(m.mensagem).slideDown())})},h;$("#id_email").keyup(function(){clearTimeout(h);
h=setTimeout(e,1001)});$("#formularioCheckout .control-group.required .controls input").focusout(function(){if("id_senha"===$(this).attr("id")){if(5>$(this).val().length)return $(this).parents(".required").addClass("erro error"),$(this).next(".help-block").text("M\u00ednimo 5 caracteres").slideDown(),!1;var f=$("#id_confirmacao_senha");f.val()&&f.val()!==$(this).val()&&(f.parents(".required").addClass("erro error"),f.next(".help-block").text("As senhas digitadas n\u00e3o coincidem").slideDown())}else if("id_confirmacao_senha"===
$(this).attr("id")){if($(this).val()!==$("#id_senha").val())return $(this).parents(".required").addClass("erro error"),$(this).next(".help-block").text("As senhas digitadas n\u00e3o coincidem").slideDown(),!1}else if("id_email"===$(this).attr("id")){if(!validateEmail(this.value))return $(this).parents(".required").addClass("erro error"),$(this).next(".help-block").text("Email inv\u00e1lido").slideDown(),!1}else if("id_nome"===$(this).attr("id")){if(0>this.value.trim().indexOf(" "))return $(this).parents(".required").addClass("erro error"),
$(this).next(".help-block").text("Digite seu nome completo").slideDown(),!1}else if("id_cpf"===$(this).attr("id")){f=this.value.replace(/\.|-/gi,"");if(!validateCPF(f))return $(this).parents(".required").addClass("erro error"),$(this).next(".help-block").text("CPF inv\u00e1lido").slideDown(),!1;if(a(f))return $(this).parents(".required").addClass("error"),$(this).next(".help-block").text("CPF j\u00e1 cadastrado").slideDown(),!1}else if("id_numero"===$(this).attr("id")&&"20"===$(this).attr("maxlength")){if(6<
$(this).val().length)return $(this).parents(".required").addClass("erro error"),$(this).next(".help-block").text("M\u00e1ximo 6 caracteres").slideDown(),!1}else if("id_telefone_celular"===$(this).attr("id")){if(0==$(this).val().length)return $(this).parents(".required").addClass("erro error"),$(this).next(".help-block").text("Este campo \u00e9 obrigat\u00f3rio.").slideDown(),!1;if(!validateDDD($(this).val().slice(1,3)))return $(this).parents(".required").addClass("erro error"),$(this).next(".help-block").text("DDD inv\u00e1lido").slideDown(),
!1}""===this.value||0<=this.value.indexOf("__")?($(this).parents(".required").addClass("erro error"),$(this).next(".help-block").text("Este campo \u00e9 obrigat\u00f3rio").slideDown()):($(this).parents(".required").removeClass("erro error"),$(this).next(".help-block").slideUp())});$("#formularioCheckout .control-group.parent_div_id_telefone_principal .controls input").focusout(function(){if("id_telefone_principal"===$(this).attr("id")){if(0!=$(this).val().length&&!validateDDD($(this).val().slice(1,
3)))return $(this).parents(".parent_div_id_telefone_principal").addClass("erro error"),$(this).next(".help-block").text("DDD inv\u00e1lido").slideDown(),!1;$(this).parents(".parent_div_id_telefone_principal").removeClass("erro error");$(this).next(".help-block").slideUp()}});$("#formularioCheckout #escolha-cartao .cartao_dados_numero").focusout(function(){var f=$(this).val().replace(/\D/g,"");currentCardValueUsed!==f&&("object"===typeof requestValorDataOld&&null!==requestValorDataOld&&requestValorDataOld.forma_pagamento_id&&
(requestValorDataOld.forma_pagamento_id=null),(currentCardValueUsed=f)&&13<=f.length?identificarBandeiraCartao(f):resetBandeiraSelecionada())});$("#escolha-cartao #cartao_cartao_parcelas").change(function(){var f=$(this);(f=f.find("option[value='"+f.val()+"']").data("valor-total"))&&alteraValorTotal(f,!0)});$("#formularioCheckout #id_politica_privacidade").change(function(){$parent=$(this).parents(".required");$helpBlock=$parent.find(".help-block");$parent.toggleClass("erro error",!this.checked);
this.checked?$helpBlock.slideUp():$helpBlock.slideDown()});$('[data-toggle="tooltip"]').tooltip();$("#finalizarCompra").click(function(f){f.preventDefault();atualizarDadosCliente();validarCheckout(!0)&&($("#finalizarCompra").button("loading"),$("#finalizarCompra").addClass("is_loading"),f=$("#formasPagamento input[name=forma_pagamento]:checked"),"radio-cartao"===f.attr("id")?proxyRequestCardToken():"radio-pptransparente"===f.attr("id")&&"function"===typeof paypalPlusDoCheckout?paypalPlusDoCheckout():
201==f.val()||46==f.val()?validarPagarNaEntrega():"radio-pagsegurov2-6"===f.attr("id")?requestFingerPrintBoleto():submitCheckoutForm());return!1});var k;$("#formularioCheckout").submit(function(f){var l=$(this);clearTimeout(k);if(validarCheckout(!1)&&!0!==l.data("submitted"))return $("#cartao_cartao_numero").val("**** **** **** ****"),$("#cartao_cartao_cvv").val("***"),l.data("submitted",!0),k=setTimeout(function(){erroTenteNovamente("Falha ao realizar pedido. Tente novamente. (ERRTM01)");sendFrontLogToKibana("ERRTM01");
l.data("submitted",!1)},5E5),!0;f.preventDefault();return!1});b=new URLSearchParams(window.location.search);"undefined"!==typeof social_login_autocomplete&&(social_login_autocomplete.hasOwnProperty("email")&&$("#id_email").val(social_login_autocomplete.email),social_login_autocomplete.hasOwnProperty("name")&&$("#id_nome").val(social_login_autocomplete.name));if($("#id_email").val()||b.get("email"))b.get("email")&&$("#id_email").val(decodeURIComponent(b.get("email"))),exibirCadastro();$(".identificacao").length||
selecionar_pagamento_padrao();$(".anonimo-fazer-login").click(function(){exibirLogin();$(".identificacao #id_senha_login").focus()});payment_system_card&&$(".li-box-payment-cc").length&&"undefined"!==typeof proxy_pci_saved_cards_url&&(checkUserHasSavedCard(),$("#escolha-cartao .group_cartao_salvar").slideDown().find(".cartao_salvar_check").prop("checked",!0))});$(window).on("resize",function(){clearTimeout(a);var a=setTimeout(resize,100)});
function sendFrontLogToKibana(a,b){if(b)try{if("radio-cartao"===$("#formasPagamento input[name=forma_pagamento]:checked").attr("id")){b=JSON.stringify(b);if(token_data&&token_data[0].cardNumber){var c=String(token_data[0].cardNumber),d=c.slice(0,6),e=c.slice(-4);b=b.split(c).join(d+"******"+e)}b=JSON.parse(b)}}catch(h){}$.ajax({url:"/checkout/logging",method:"POST",headers:{"content-type":"application/json",accept:"application/json"},data:JSON.stringify({details:b,log_message:"errorlog_checkout_frontend_"+
a,internal_error_code:a})})}
function iniciarPagarNaEntrega(){if(entrega_tipos_ativo){try{for(var a=JSON.parse(entrega_tipos_ativo),b=0;b<a.length;++b){var c=$.grep(pagar_entrega_tipos,function(e,h){return e.id==a[b]});if(c){c=c[0];var d='<option value="'+c.id+'" data-label="'+c.label+'">'+c.label+"</option>";$("#id_escolher_tipo_pagamento").append(d)}}}catch(e){console.log(e),$(".accordion-group.entrega").remove()}$(".li-box-payment #id_valor_troco").maskMoney({thousands:".",decimal:",",prefix:"R$ ",allowZero:!0,affixesStay:!1});
$(".li-box-payment #id_escolher_tipo_pagamento").change(function(){var e=$("#id_valor_troco"),h=e.parent(),k=$(this).find("option:checked").attr("data-label");"Dinheiro"===k?h.slideDown():(h.slideUp(),e.val("0,00"));$(".li-box-payment #id_tipo_pagamento").val(k)}).change()}}
function validarPagarNaEntrega(){valor_troco=$(".li-box-payment #id_valor_troco").val().replace("R$ ","").replace(".","").replace(",",".");valor_troco=parseFloat(valor_troco);valor_pagamento=$(".li-box-payment .pagamento-valor").text().replace("R$ ","").replace(".","").replace(",",".");valor_pagamento=parseFloat(valor_pagamento);"Dinheiro"==$(".li-box-payment #id_tipo_pagamento").val()&&valor_troco<valor_pagamento&&0<valor_troco?(alert("Voc\u00ea precisa informar um valor para troco maior do que o valor da compra."),
$("#finalizarCompra").button("reset")):$(".li-box-payment #id_tipo_pagamento").val()?$("#formularioCheckout").submit():(alert("Selecione o tipo de pagamento na entrega"),$("#finalizarCompra").button("reset"))}
function iniciarTransparente(){var a=[];for(i=0;i<payment_system_card.length;i++)a.push(payment_system_card[i].code);(a.indexOf("pagseguro")+1||a.indexOf("pagsegurov2")+1)&&iniciarPagseguroTransparente();a.indexOf("mercadopagov1")+1&&iniciarMercadoPagoTransparente();a.indexOf("proxy-cielo-v1-cartao")+1&&iniciarCieloTransparente();a.indexOf("proxy-mercadopago-v1-cartao")+1&&iniciarMercadoPagoTransparente();a.indexOf("pagali-cartao")+1&&(iniciarProxyTransparente(),1<a.length&&(console.log("Mais de uma forma de pagamento via cart\u00e3o transparente identificado. Para que o checkout funcione corretamente, use apenas 1 forma de pagamento via cart\u00e3o transparente."),
sendFrontLogToKibana("ERRMULTICARD",{array_active_cards:a})));a.findIndex(b=>b.startsWith("proxy")&&b.endsWith("cartao"))+1&&(iniciarProxyTransparente(),1<a.length&&(console.log("Mais de uma forma de pagamento via cart\u00e3o transparente identificado. Para que o checkout funcione corretamente, use apenas 1 forma de pagamento via cart\u00e3o transparente."),sendFrontLogToKibana("ERRMULTICARD",{array_active_cards:a})))}var pagseguro_iniciado=!1;
function iniciarPagseguroTransparente(){setTimeout(function(){var a=document.createElement("script"),b=document.getElementsByTagName("script")[0];a.src=document.location.protocol+"//stc.pagseguro.uol.com.br/pagseguro/api/v2/checkout/pagseguro.directpayment.js?"+Math.floor((new Date).getTime()/36E5);a.async=!0;a.type="text/javascript";b.parentNode.insertBefore(a,b)},1);pagseguro_iniciado=!0}var mercadopago_iniciado=!1;
function iniciarMercadoPagoTransparente(){setTimeout(function(){$("body").append("<form><input type='hidden' id='deviceId' name='deviceId'></form>");var a=document.createElement("script"),b=document.getElementsByTagName("script")[0];a.src="https://www.mercadopago.com/v2/security.js";a.view="checkout";a.output="deviceId";a.async=!0;a.type="text/javascript";b.parentNode.insertBefore(a,b)},1);mercadopago_iniciado=!0}var cielo_iniciado=!1;
function iniciarCieloTransparente(){var a=$("#payment_fingerprint").val();a||=uuidv4();var b="https://h.online-metrix.net/fp/tags?org_id="+("sandbox"==store_current_amb?"1snn5n9w":"k8vif92e")+"&session_id=braspag_lojaintegrada"+a;setTimeout(function(){var c=document.createElement("script"),d=document.getElementsByTagName("script")[0];c.src=b.replace("/tags?","/tags.js?");c.async=!0;c.type="text/javascript";d.parentNode.insertBefore(c,d);$("body").append('<noscript><iframe style="width: 100px; height: 100px; border: 0; position:absolute; top: -5000px;" src="'+
b+'"></iframe></noscript>')},1);$("#payment_fingerprint").val(a);cielo_iniciado=!0}var proxy_transparente_iniciado=!1;function iniciarProxyTransparente(){proxy_transparente_iniciado=!0};
